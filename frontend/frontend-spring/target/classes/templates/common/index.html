<!DOCTYPE html>
<html layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Home Page</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>
<div layout:fragment="body">
    <h1>My home page</h1>

    <a th:href="@{/login}">Login page</a>


    <div sec:authorize="hasAnyRole('CLIENT', 'ADMIN')">
        <h2>Jokes</h2>

        <div id="jokeContainer">

        </div>
    </div>

</div>
<script>
    function getJoke(){
        $.get("https://api.chucknorris.io/jokes/random", function(data) {
            var joke = data.value;

            $("#jokeContainer").text(joke);
        }).fail(function() {
           console.error("Failed to fetch joke");
        });
    }

    $(document).ready(function(){
        getJoke();

        setInterval(getJoke, 100000);
    });
</script>
</body>
</html>